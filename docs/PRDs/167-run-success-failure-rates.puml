@startuml
!theme plain

title Run Success/Failure Rates Implementation

package "MeshHook System" {
    [Workflow Execution Engine] as WEE
    database "Supabase Realtime" as Supabase
    [SvelteKit Dashboard] as Dashboard
}

database "Metrics Database" as MetricsDB {
    table "workflow_run_metrics" as MetricsTable {
        column "workflow_id": FK
        column "success_count": Integer
        column "failure_count": Integer
        column "last_updated": Timestamp
    }
}

package "API" {
    [GET /metrics/workflow/{workflow_id}] as GetWorkflowMetrics
    [GET /metrics/workflows/summary] as GetSummaryMetrics
}

WEE --> MetricsDB : "Captures run results\nand updates metrics"
MetricsDB --> Supabase : "Pushes updates"
Supabase --> Dashboard : "Displays metrics\nin real-time"
Dashboard --> GetWorkflowMetrics : "Queries specific\nworkflow metrics"
Dashboard --> GetSummaryMetrics : "Queries summary\nmetrics across workflows"

note right of WEE : Integration Point\nfor capturing run results
note right of Supabase : Real-time updates\nto dashboard
note right of MetricsTable : New table for\nstoring metrics data

@enduml