@startuml
!theme plain

package "MeshHook System" {
    [Webhook Processor] - [Caching Layer]
    [Workflow Executor] - [Caching Layer]
    [API Server] - [Caching Layer]
    [Caching Layer] - [Database]
    [Caching Layer] .> [Cache Invalidation Service] : triggers
    [Cache Invalidation Service] .> [Database] : syncs
    database Database {
        [Workflow Definitions]
        [Node Configurations]
        [Execution States]
    }
    [Monitoring & Logging] ..> [Caching Layer] : observes
}

node "Cache Storage" {
    [Cache Data]
}

node "External Services" {
    [Supabase Realtime] <-- [API Server] : streams logs
    [Postgres] - [Database]
}

[Database] - [Postgres] : uses
[Caching Layer] - [Cache Data] : caches

note right of [Caching Layer]
  Cache Keys:
  - Workflow Definitions
  - Node Configurations
  - Execution States
end note

note right of [Cache Invalidation Service]
  Ensures data consistency
  between cache and database
end note

note right of [Monitoring & Logging]
  Tracks:
  - Cache hit/miss ratios
  - Load and memory usage
  - Invalidation and error events
end note

[Caching Layer] ..> [External Services] : integrates with\nexisting architecture

@enduml