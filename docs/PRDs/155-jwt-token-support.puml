@startuml
!theme plain

package "Webhook System" {
    [Webhook Trigger] -right-> [JWT Verification]
    [JWT Verification] -down-> [Secrets Vault] : fetches JWT secrets
    [JWT Verification] -left-> [Logging & Metrics]
    database "Supabase Postgres" {
        [jwt_config] - [webhook_triggers]
    }
    [Webhook Trigger] -down-> [Supabase Postgres]
}

package "Configuration Interface" {
    [UI] -right-> [API Endpoint]
    [API Endpoint] --> [Supabase Postgres] : updates jwt_config
}

[JWT Library] - [JWT Verification]

note right of [JWT Verification]
  1. Extract JWT from request
  2. Fetch secret from Secrets Vault
  3. Verify JWT signature and claims
  4. Log attempt and outcome
end note

note right of [API Endpoint]
  Method: PUT
  Path: /api/v1/projects/{projectId}/webhooks/{webhookId}/jwt-config
  Body: { "secret": "string", "claims": {"iss": "example.com", "aud": "meshhook"} }
end note

[UI] ..> [SvelteKit] : uses
[SvelteKit] ..> [Webhook Trigger] : integrates
[Logging & Metrics] ..> [Supabase] : utilizes for real-time logging and metrics

@enduml