@startuml
!theme plain

title Security Audit Process for MeshHook

actor Auditor
entity "Security Audit\nTeam" as AuditTeam
database "Supabase\n(Postgres)" as Supabase
entity "SvelteKit\n(SSR/API)" as SvelteKit
entity "Workers\n(Orchestrator & HTTP Executor)" as Workers
cloud "Third-party\nDependencies" as Dependencies
cloud "External Services\n(Supabase Realtime, Storage)" as ExternalServices

Auditor --> AuditTeam : Initiates
AuditTeam --> Supabase : Assess Database\n& Real-time Operations
AuditTeam --> SvelteKit : Evaluate SSR/API\nSecurity Practices
AuditTeam --> Workers : Check Workers\nfor Security Issues
AuditTeam --> Dependencies : Review for\nKnown Vulnerabilities
AuditTeam --> ExternalServices : Verify Integration\n& Data Handling

Supabase -[hidden]-> SvelteKit
SvelteKit -[hidden]-> Workers
Workers -[hidden]-> Dependencies
Dependencies -[hidden]-> ExternalServices

group Security Audit Phases
    AuditTeam -> Supabase : Static Code Analysis
    AuditTeam -> Supabase : Penetration Testing
    AuditTeam -> SvelteKit : Dependency Analysis
    AuditTeam -> Workers : Compliance Check
    AuditTeam -> ExternalServices : Security Best Practices Review
end

note right of AuditTeam : Reporting &\nRecommendations

AuditTeam --> Auditor : Document Findings\n& Recommendations

@enduml