@startuml
!theme plain

package "MeshHook System" {
    [Webhook Intake] as Webhook
    [Workflow CRUD API] as CRUD
    [Publish Versions] as Publish
    [Run Console] as Console
    [Supabase Realtime] as Realtime
    [Postgres] as Postgres
    [Storage] as Storage
    [Edge (cron/timers)] as Edge
    [Orchestrator Worker] as Orchestrator
    [HTTP Executor Worker] as Executor
    [Application Metrics] as Metrics
}

database "Supabase" {
    [Postgres] - [Data + Queues]
    [Realtime] - [Log Streaming]
    [Storage] - [Artifacts]
}

[Webhook] --> [Postgres] : Triggers & Data
[CRUD] --> [Postgres] : Manage Workflows
[Publish] --> [Postgres] : Version Control
[Console] --> [Realtime] : Live Logs
[Orchestrator] --> [Postgres] : State Management
[Executor] --> [Postgres] : Task Execution
[Metrics] --> [Postgres] : Stores Metrics Data
[Metrics] --> [Realtime] : Live Metrics Updates
[Metrics] .> [Orchestrator] : Monitors & Alerts
[Metrics] .> [Executor] : Monitors & Alerts
[Metrics] .> [Edge] : Monitors Scheduled Tasks
[Metrics] .> [Webhook] : Tracks Trigger Performance

note right of [Metrics]
  Key Metrics:
  - Response Times
  - Error Rates
  - Resource Usage
  - Trigger Performance
end note

note "Integration Points" as IP
[Webhook] .. IP
[CRUD] .. IP
[Publish] .. IP
[Console] .. IP
[Orchestrator] .. IP
[Executor] .. IP
[Edge] .. IP
IP .. [Metrics] : Monitors & Integrates
end note

@enduml