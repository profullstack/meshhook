@startuml
!theme plain

package "Queue Health Monitoring System" {
    [Queue Metrics Collector] --> [Supabase Realtime]: Subscribes for queue metrics
    [Queue Metrics Collector] --> [Alerting Mechanism]: Sends metrics for evaluation
    [Dashboard] --> [Supabase Realtime]: Fetches real-time metrics
    [Alerting Mechanism] --> [Notification Service]: Triggers alerts
}

package "Existing MeshHook System" {
    [Supabase Realtime] <-- [Postgres Queues]: Streams queue events
    [Workflow Engine] --> [Postgres Queues]: Processes webhook events\nand workflow executions
}

database "Postgres Queues" {
    folder "pg-boss" {
    }
    folder "pgmq" {
    }
}

[Queue Metrics Collector] ..> [Postgres Queues] : Collects metrics from
[Dashboard] ..> [Queue Metrics Collector] : Displays metrics from
[Alerting Mechanism] ..> [Dashboard] : Configures alerts in

[Workflow Engine] -up-> [Supabase]: Utilizes
[Notification Service] -right-> [Team Members]: Sends alerts to

note right of [Queue Metrics Collector]
  Collects key metrics like queue length,
  processing time, and error rates.
end note

note right of [Alerting Mechanism]
  Evaluates metrics against predefined
  thresholds to trigger alerts.
end note

note right of [Dashboard]
  Provides real-time visualization of
  queue health to the MeshHook team.
end note

note right of [Notification Service]
  Supports email, SMS, or webhook
  notifications for critical alerts.
end note

@enduml