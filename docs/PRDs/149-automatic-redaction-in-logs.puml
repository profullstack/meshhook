@startuml
!theme plain

package "MeshHook System" {
    [Logging Service] --> [Redaction Engine]: Sends logs for redaction
    [Redaction Engine] --> [Database]: Stores audit trails
    [Redaction Engine] -right-> [Supabase Realtime]: Subscribes to log updates
    [Database] --> [Management API]: CRUD operations for rules
    [Logging Service] .> [SvelteKit Components]: Generates logs
    [Logging Service] .> [Workers]: Generates logs
    [Management API] --> [Client]: Exposes redaction rules management
}

package "External Systems" {
    [Supabase Realtime] -[hidden]-> [Database]
}

[Client] --> [Management API]: "POST /api/redaction-rules\nGET /api/redaction-rules\nDELETE /api/redaction-rules/{id}"

note right of [Redaction Engine]
    1. Detects PII in logs
    2. Applies redaction rules
    3. Stores audit trail
end note

note right of [Database]
    Stores:
    - log_redaction_rules
    - log_redaction_audit
end note

note right of [Management API]
    Manages:
    - Creation of rules
    - Listing of rules
    - Deletion of rules
end note

note right of [Logging Service]
    Integrates with:
    - SvelteKit Components
    - Workers
end note

@enduml