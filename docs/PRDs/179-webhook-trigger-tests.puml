@startuml
!theme plain

title Webhook Trigger Tests - Workflow

actor Developer as dev
participant "Test Framework\n(Jest)" as jest
participant "Mock Service" as mock
database "Supabase\n(Postgres, Realtime, Storage)" as supabase
participant "MeshHook\nWebhook Engine" as meshhook
participant "CI Environment" as ci

== Test Preparation ==
dev -> jest : Review & design tests
dev -> mock : Identify mocks for\nexternal services

== Test Development ==
jest -> mock : Develop mocks for\nisolated testing
jest -> jest : Implement tests using TDD

== Execution and Refinement ==
group Local Testing
    dev -> jest : Execute tests locally
    jest -> meshhook : Trigger webhook events
    meshhook -> supabase : Process webhook\nvia workflow engine
    supabase --> meshhook : Return processing results
    meshhook --> jest : Test assertions
    jest --> dev : Report results
end

group CI Testing
    dev -> ci : Push code\nfor CI tests
    ci -> jest : Run tests in CI
    jest -> meshhook : Trigger webhook events
    meshhook -> supabase : Process webhook\nvia workflow engine
    supabase --> meshhook : Return processing results
    meshhook --> jest : Test assertions
    jest --> ci : Report results
    ci --> dev : CI test feedback
end

== Documentation ==
dev -> meshhook : Document test cases\nand results

@enduml