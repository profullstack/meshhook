@startuml
!theme plain

title Multi-tenant Isolation Tests for MeshHook

actor Tester

package "MeshHook System" {
    [API Gateway] - [Authentication Service]
    [API Gateway] --> [Workflow Execution Service]
    [API Gateway] --> [Data Storage\n(Supabase/Postgres)]
    [Data Storage\n(Supabase/Postgres)] ..> (Row-Level Security)
    [Workflow Execution Service] ..> (Isolation Verification)
    [Data Storage\n(Supabase/Postgres)] ..> (Secrets Security)
    [Data Storage\n(Supabase/Postgres)] ..> (Audit Logs)
    
    package "Integration Testing Framework" {
        [Test Runner] - [Test Scenarios]
        [Test Scenarios] ..> (API Security Tests)
        [Test Scenarios] ..> (Workflow Execution Isolation)
        [Test Scenarios] ..> (Isolation Verification)
        [Test Scenarios] ..> (Secrets Security)
        [Test Scenarios] ..> (Audit Logs)
    }
}

[Tester] --> [Test Runner] : Executes tests
[Test Runner] --> [API Gateway] : Simulates multi-tenant operations
[Authentication Service] --> [Data Storage\n(Supabase/Postgres)] : Validates tenant access
[Workflow Execution Service] --> [Data Storage\n(Supabase/Postgres)] : Executes tenant-specific workflows

note right of [API Security Tests]
  Ensure API endpoints reject
  unauthorized cross-tenant access attempts
end note

note right of (Row-Level Security)
  Enforces data isolation at the database level
end note

note right of (Isolation Verification)
  Verify no data leaks across tenants
end note

note right of [Test Runner]
  Integrates with CI/CD pipeline
end note

footer Generated: 2025-10-10 | PRD: Multi-tenant Isolation Tests

@enduml