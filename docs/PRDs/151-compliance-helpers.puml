@startuml
!theme plain

package "MeshHook System" {
    [Webhook Intake] --> [PII Detection & Redaction] : processes payload
    [Workflow Logs] --> [PII Detection & Redaction] : logs data
    [PII Detection & Redaction] --> [Compliance Policies DB] : queries policies
    [PII Detection & Redaction] .> [Audit Logs DB] : logs actions
    [User Interface] --> [Compliance Policies DB] : configures policies
    [API] --> [Compliance Policies DB] : manages via endpoints
    [API] --> [Audit Logs DB] : fetches logs
}

database "Compliance Policies DB" {
    [CompliancePolicies]
}

database "Audit Logs DB" {
    [AuditLogs]
}

cloud {
    [Regex Libraries]
}

[PII Detection & Redaction] --> [Regex Libraries] : uses for pattern recognition

[User Interface] --> [PII Detection & Redaction] : configures detection and redaction
[API] -right-> [PII Detection & Redaction] : extends functionality

note right of [PII Detection & Redaction]
  Key Operations:
  - Detect PII
  - Redact based on policies
  - Log redaction activities
end note

note right of [Compliance Policies DB]
  Stores:
  - PII definitions
  - Redaction strategies
end note

note right of [Audit Logs DB]
  Stores:
  - Policy changes
  - Redaction logs
end note

@enduml