@startuml
!theme plain

title Webhook for Alerts Implementation

package "MeshHook System" {
    [Supabase Realtime] as Realtime
    [HTTP Executor Worker] as Worker
    [SvelteKit UI] as UI
    database "Database" {
        [alert_configs]
        [alert_logs]
    }
}

cloud {
    [External Webhook Endpoints] as Webhooks
}

package "API" {
    [POST /api/alerts/config] as PostConfig
    [GET /api/alerts/config/{workflowId}] as GetConfig
    [POST /api/alerts/test] as PostTest
}

UI --> PostConfig : configure alerts
UI --> GetConfig : retrieve alert config
UI --> PostTest : test webhook

Realtime --> Worker : workflow events
Worker --> Database : log attempts
Worker --> Webhooks : dispatch webhook\nwith retry
PostConfig --> Database : store config
GetConfig --> Database : query config

note right of Webhooks : Signature Verification

legend right
  **Data Model Changes**
  - alert_configs
  - alert_logs
endlegend

@enduml