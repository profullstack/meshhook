@startuml
!theme plain

title GitHub Actions Workflows for MeshHook CI/CD

actor Developer as dev
boundary GitHub as GH
control "CI Workflow" as CI
control "CD Workflow" as CD
control "Security Scanning\nWorkflow" as SecScan
database "Supabase\n(Postgres, Realtime, Storage)" as Supabase
[Supabase Edge] as Edge
[Workers] as Workers
entity "SvelteKit\n(SSR/API)" as SvelteKit

dev --> GH : Push code\nCreate PR
GH --> CI : Trigger on push/PR
CI --> SvelteKit : Build
CI --> Supabase : Run Tests
CI --> GH : Report Status

dev --> GH : Merge PR
GH --> CD : Trigger on merge
CD --> Supabase : Deploy to Staging
CD --> Edge : Deploy Cron/Timers
CD ..> GH : Manual Prod Deployment Trigger
CD --> Supabase : Deploy to Production

GH --> SecScan : Schedule/On Demand
SecScan --> GH : Alert on Vulnerabilities

note right of CI : Validates\n- Coding standards\n- Linting\n- Unit/Integration tests
note right of CD : Staging & Production\n- Smoke tests\n- Manual approval for Prod
note right of SecScan : Weekly + On Demand\n- Static code analysis

SvelteKit --> Supabase : CRUD Operations
Supabase --> Workers : Queue Tasks
Workers --> Supabase : Update State
Workers --> Edge : Schedule Tasks

@enduml