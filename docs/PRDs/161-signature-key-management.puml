@startuml
!theme plain

package "Webhook Management UI" {
    [Signature Key Management] as SKM
    [Webhook Trigger with Verification] as WTV
    [Visual DAG Builder] as VDB
    [Event Sourcing] as ES
    [Live Logs via Supabase] as LL
    [Multi-tenant RLS Security] as MRLS
}

database "Supabase" {
    frame Postgres {
        [Data + Queues] as DBQ
        [Schema.sql] as Schema
    }
    frame Realtime {
        [Log Streaming] as LS
    }
    frame Storage {
        [Artifacts] as Artifacts
    }
    frame Edge {
        [Cron/Timers] as Cron
    }
}

[SKM] --> [WTV] : Verifies Signatures
[SKM] --> [MRLS] : Utilizes\nSecurity Model
[SKM] ..> [DBQ] : Reads/Writes\nKeys
[SKM] ..> [Schema] : May Update\nIf Required
[SKM] --> [ES] : Triggers Events
[SKM] --> [LL] : Logs Key\nManagement Actions

note right of [SKM]
  Implement key management
  functionalities including:
  - Generation
  - Rotation
  - Revocation
end note

package "External Services" {
    [SvelteKit SSR/API] as SvelteKit
    [Workers] as Workers
    [HTTP Executor] as HTTPExec
}

[SvelteKit] --> [VDB] : Provides UI for\nDAG Configuration
[Workers] --> [ES] : Handles State\nMachine & Scheduling
[HTTPExec] --> [WTV] : Executes Webhook\nCalls with Retries

note "Technical Stack" as TS
note right of [SvelteKit]
  SvelteKit is used for rendering
  the Webhook Management UI and
  handling API requests.
end note

note right of [Workers]
  Orchestrates workflow
  execution and scheduling.
end note

note right of [HTTPExec]
  Robust HTTP client for
  webhook execution with
  retries and backoff.
end note

TS ..> SvelteKit
TS ..> Workers
TS ..> HTTPExec

@enduml