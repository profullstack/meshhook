@startuml
!theme plain

title Dark Mode Implementation Flow

actor User
entity "UI Theme Switcher" as Switcher
control "SvelteKit SSR/API" as SSR
database "Postgres" as DB
entity "Supabase Realtime" as Realtime
control "HTTP Executor" as Executor

User -> Switcher : Toggle Dark Mode
Switcher -> SSR : Request Dark Mode UI
SSR -> DB : Check User Preferences
DB --> SSR : Return Preferences
SSR -> Switcher : Serve Dark Mode UI
Switcher --> User : Display Dark Mode

SSR -> Executor : Trigger UI Update Event
Executor -> Realtime : Log UI Change
Realtime --> User : Notify UI Update

@enduml