import"../chunks/CWj6FrbW.js";import{ab as Z,ac as d,ag as s,ah as r,af as l,aj as K,J as o,al as T,aa as c,ad as $,am as G,ak as tt,ae as at,an as I}from"../chunks/DLTaHJlt.js";import{d as et,s as g,a as rt}from"../chunks/BZOnZgKm.js";import{i as O}from"../chunks/D6SFIRjf.js";import{e as Q,i as nt}from"../chunks/B9wM4kaC.js";import{s as st,b as X}from"../chunks/Ihp2QH7c.js";import{g as Y}from"../chunks/jEEpMCDI.js";var lt=d('<div class="meta-item error svelte-7ka0tr"><span class="meta-label svelte-7ka0tr">Error:</span> <span class="meta-value svelte-7ka0tr"> </span></div>'),it=(p,t)=>{var v;return(v=t.onView)==null?void 0:v.call(t,t.run)},ot=(p,t)=>{var v;return(v=t.onRetry)==null?void 0:v.call(t,t.run)},vt=d('<button class="btn-action svelte-7ka0tr">Retry</button>'),ut=(p,t)=>{var v;return(v=t.onCancel)==null?void 0:v.call(t,t.run)},ct=d('<button class="btn-action btn-danger svelte-7ka0tr">Cancel</button>'),dt=d('<div class="run-card svelte-7ka0tr"><div class="card-header svelte-7ka0tr"><div class="run-info svelte-7ka0tr"><h4 class="run-id svelte-7ka0tr"> </h4> <span class="status-badge svelte-7ka0tr"> </span></div> <span class="run-date svelte-7ka0tr"> </span></div> <div class="card-body svelte-7ka0tr"><div class="run-meta svelte-7ka0tr"><div class="meta-item svelte-7ka0tr"><span class="meta-label svelte-7ka0tr">Workflow:</span> <span class="meta-value svelte-7ka0tr"> </span></div> <div class="meta-item svelte-7ka0tr"><span class="meta-label svelte-7ka0tr">Duration:</span> <span class="meta-value svelte-7ka0tr"> </span></div> <!></div></div> <div class="card-actions svelte-7ka0tr"><button class="btn-action svelte-7ka0tr">View Details</button> <!> <!></div></div>');function _t(p,t){Z(t,!0);const v={pending:"#fbbf24",running:"#3b82f6",completed:"#10b981",failed:"#ef4444",cancelled:"#6b7280"},y=T(()=>v[t.run.status]||"#6b7280");function j(i){return i?new Date(i).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}function H(i,u){if(!i)return"N/A";const h=new Date(i),B=u?new Date(u):new Date,w=Math.floor((B-h)/1e3);return w<60?`${w}s`:w<3600?`${Math.floor(w/60)}m ${w%60}s`:`${Math.floor(w/3600)}h ${Math.floor(w%3600/60)}m`}const A=T(()=>H(t.run.started_at,t.run.completed_at));var D=dt(),S=s(D),E=s(S),M=s(E),N=s(M);r(M);var x=l(M,2),V=s(x,!0);r(x),r(E);var _=l(E,2),W=s(_,!0);r(_),r(S);var f=l(S,2),z=s(f),m=s(z),C=l(s(m),2),F=s(C,!0);r(C),r(m);var k=l(m,2),R=l(s(k),2),J=s(R,!0);r(R),r(k);var L=l(k,2);{var q=i=>{var u=lt(),h=l(s(u),2),B=s(h,!0);r(h),r(u),K(()=>g(B,t.run.error)),c(i,u)};O(L,i=>{t.run.error&&i(q)})}r(z),r(f);var P=l(f,2),a=s(P);a.__click=[it,t];var e=l(a,2);{var n=i=>{var u=vt();u.__click=[ot,t],c(i,u)};O(e,i=>{t.run.status==="failed"&&i(n)})}var b=l(e,2);{var U=i=>{var u=ct();u.__click=[ut,t],c(i,u)};O(b,i=>{(t.run.status==="running"||t.run.status==="pending")&&i(U)})}r(P),r(D),K((i,u)=>{var h;g(N,`Run #${i??""}`),st(x,`background-color: ${o(y)??""}`),g(V,t.run.status),g(W,u),g(F,((h=t.run.workflow)==null?void 0:h.name)||"Unknown"),g(J,o(A))},[()=>t.run.id.slice(0,8),()=>j(t.run.created_at)]),c(p,D),$()}et(["click"]);var ft=d("<option> </option>"),mt=d('<div class="empty-state svelte-1btsuzj"><p class="empty-icon svelte-1btsuzj">üèÉ</p> <p class="empty-text svelte-1btsuzj">No runs found</p></div>'),kt=d('<div class="runs-grid svelte-1btsuzj"></div>'),bt=d('<div class="runs-page svelte-1btsuzj"><header class="page-header svelte-1btsuzj"><h1 class="svelte-1btsuzj">Workflow Runs</h1></header> <div class="runs-content svelte-1btsuzj"><div class="filters svelte-1btsuzj"><select class="filter-select svelte-1btsuzj"><option>All Status</option><option>Pending</option><option>Running</option><option>Completed</option><option>Failed</option><option>Cancelled</option></select> <select class="filter-select svelte-1btsuzj"><option>All Workflows</option><!></select></div> <!></div></div>');function zt(p,t){Z(t,!0);let v=G(tt(t.data.runs||[])),y=G("all"),j=G("all");const H=T(()=>()=>{let a=o(v);return o(y)!=="all"&&(a=a.filter(e=>e.status===o(y))),o(j)!=="all"&&(a=a.filter(e=>e.workflow_id===o(j))),a}),A=o(H)(),D=T(()=>Array.from(new Set(o(v).map(a=>a.workflow_id))).map(a=>{var n;const e=o(v).find(b=>b.workflow_id===a);return{id:a,name:((n=e==null?void 0:e.workflow)==null?void 0:n.name)||"Unknown"}}));function S(a){Y(`/runs/${a.id}`)}async function E(a){try{const e=await fetch(`/api/runs/${a.id}/retry`,{method:"POST"});if(!e.ok)throw new Error("Failed to retry run");const n=await e.json();alert(`New run created: ${n.run.id}`),Y(`/runs/${n.run.id}`)}catch(e){alert(`Error retrying run: ${e.message}`)}}async function M(a){if(confirm("Cancel this run?"))try{if(!(await fetch(`/api/runs/${a.id}/cancel`,{method:"POST"})).ok)throw new Error("Failed to cancel run");I(v,o(v).map(n=>n.id===a.id?{...n,status:"cancelled"}:n),!0)}catch(e){alert(`Error cancelling run: ${e.message}`)}}var N=bt();rt(a=>{at.title="Runs - MeshHook"});var x=l(s(N),2),V=s(x),_=s(V),W=s(_);W.value=W.__value="all";var f=l(W);f.value=f.__value="pending";var z=l(f);z.value=z.__value="running";var m=l(z);m.value=m.__value="completed";var C=l(m);C.value=C.__value="failed";var F=l(C);F.value=F.__value="cancelled",r(_);var k=l(_,2),R=s(k);R.value=R.__value="all";var J=l(R);Q(J,17,()=>o(D),nt,(a,e)=>{var n=ft(),b=s(n,!0);r(n);var U={};K(()=>{g(b,o(e).name),U!==(U=o(e).id)&&(n.value=(n.__value=o(e).id)??"")}),c(a,n)}),r(k),r(V);var L=l(V,2);{var q=a=>{var e=mt();c(a,e)},P=a=>{var e=kt();Q(e,21,()=>A,n=>n.id,(n,b)=>{_t(n,{get run(){return o(b)},onView:S,onRetry:E,onCancel:M})}),r(e),c(a,e)};O(L,a=>{A.length===0?a(q):a(P,!1)})}r(x),r(N),X(_,()=>o(y),a=>I(y,a)),X(k,()=>o(j),a=>I(j,a)),c(p,N),$()}export{zt as component};
