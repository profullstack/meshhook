import"../chunks/CWj6FrbW.js";import{ab as ne,ac as x,ag as s,J as e,am as P,ah as t,af as l,aj as U,aa as q,ad as ce,al as R,an as u,ak as ie,b as ze,a8 as qe,a9 as ke,ai as re,aW as xe,ae as Se}from"../chunks/DLTaHJlt.js";import{d as ve,s as C,e as je,a as Ce}from"../chunks/BZOnZgKm.js";import{i as G}from"../chunks/D6SFIRjf.js";import{e as oe,i as fe}from"../chunks/B9wM4kaC.js";import{a as le,r as X,b as Ee}from"../chunks/C21iDxsO.js";import{b as Z}from"../chunks/au-VDWBU.js";import{b as be}from"../chunks/Ihp2QH7c.js";import{p as V}from"../chunks/B90PUMjC.js";function De(h,r){u(r,!e(r))}async function Te(h,r,i){try{await navigator.clipboard.writeText(r()),u(i,!0),setTimeout(()=>{u(i,!1)},2e3)}catch{alert("Failed to copy to clipboard")}}var Oe=x('<input type="text" class="secret-input svelte-f3n6kn"/>'),Ne=x('<input type="text" disabled readonly="" class="secret-input masked svelte-f3n6kn"/>'),Pe=x('<button type="button" class="btn-icon svelte-f3n6kn" title="Copy to clipboard"> </button>'),Ue=x('<div class="masked-input svelte-f3n6kn"><div class="input-container svelte-f3n6kn"><!></div> <div class="input-actions svelte-f3n6kn"><button type="button" class="btn-icon svelte-f3n6kn"> </button> <!></div></div>');function me(h,r){ne(r,!0);let i=V(r,"value",15,""),D=V(r,"placeholder",3,""),g=V(r,"disabled",3,!1),k=V(r,"readonly",3,!1),n=P(!1),v=P(!1);const H=R(()=>"•".repeat(Math.min(i().length,20)));var S=Ue(),L=s(S),I=s(L);{var J=_=>{var c=Oe();X(c),U(()=>{le(c,"placeholder",D()),c.disabled=g(),c.readOnly=k()}),Z(c,i),q(_,c)},m=_=>{var c=Ne();X(c),U(()=>{Ee(c,e(H)),le(c,"placeholder",D())}),q(_,c)};G(I,_=>{e(n)?_(J):_(m,!1)})}t(L);var w=l(L,2),y=s(w);y.__click=[De,n];var F=s(y,!0);t(y);var T=l(y,2);{var M=_=>{var c=Pe();c.__click=[Te,i,v];var O=s(c,!0);t(c),U(()=>{c.disabled=g(),C(O,e(v)?"✅":"📋")}),q(_,c)};G(T,_=>{i()&&_(M)})}t(w),t(S),U(()=>{le(y,"title",e(n)?"Hide":"Show"),y.disabled=g(),C(F,e(n)?"🙈":"👁️")}),q(h,S),ce()}ve(["click"]);function Le(h,r){h.target===h.currentTarget&&r()}var Fe=x("<option> </option>"),Me=x('<div class="modal-backdrop svelte-114zgz9" role="presentation"><div class="modal svelte-114zgz9" role="dialog" aria-modal="true"><div class="modal-header svelte-114zgz9"><h2 class="svelte-114zgz9"> </h2> <button class="close-button svelte-114zgz9" aria-label="Close">×</button></div> <div class="modal-body svelte-114zgz9"><form><div class="form-group svelte-114zgz9"><label for="name" class="svelte-114zgz9">Secret Name *</label> <input id="name" type="text" placeholder="API_KEY" required class="svelte-114zgz9"/> <p class="help-text svelte-114zgz9">Unique identifier for this secret</p></div> <div class="form-group svelte-114zgz9"><label for="value" class="svelte-114zgz9">Secret Value *</label> <!> <p class="help-text svelte-114zgz9">The encrypted value will be stored securely</p></div> <div class="form-group svelte-114zgz9"><label for="project" class="svelte-114zgz9">Project *</label> <select id="project" required class="svelte-114zgz9"><option>Select project</option><!></select> <p class="help-text svelte-114zgz9">Scope this secret to a specific project</p></div> <div class="form-group svelte-114zgz9"><label for="description" class="svelte-114zgz9">Description</label> <textarea id="description" placeholder="Optional description..." rows="3" class="svelte-114zgz9"></textarea></div> <div class="modal-actions svelte-114zgz9"><button type="button" class="btn-secondary svelte-114zgz9">Cancel</button> <button type="submit" class="btn-primary svelte-114zgz9"> </button></div></form></div></div></div>');function Ve(h,r){ne(r,!0);let i=V(r,"secret",3,null),D=V(r,"projects",19,()=>[]),g=V(r,"isOpen",15,!1);const k=R(()=>!!i());let n=P(ie({name:"",value:"",project_id:"",description:""})),v=P(!1);ze(()=>{var m;i()?u(n,{name:i().name||"",value:i().value||"",project_id:i().project_id||"",description:i().description||""},!0):u(n,{name:"",value:"",project_id:((m=D()[0])==null?void 0:m.id)||"",description:""},!0)});async function H(){var m;if(!e(n).name||!e(n).value){alert("Name and value are required");return}try{u(v,!0),await((m=r.onSave)==null?void 0:m.call(r,e(n))),S()}catch(w){alert(`Error saving secret: ${w.message}`)}finally{u(v,!1)}}function S(){g(!1)}var L=qe(),I=ke(L);{var J=m=>{var w=Me();w.__click=[Le,S];var y=s(w),F=s(y),T=s(F),M=s(T,!0);t(T);var _=l(T,2);_.__click=S,t(F);var c=l(F,2),O=s(c),Y=s(O),B=l(s(Y),2);X(B),re(2),t(Y);var K=l(Y,2),$=l(s(K),2);me($,{placeholder:"Enter secret value",get disabled(){return e(v)},get value(){return e(n).value},set value(b){e(n).value=b}}),re(2),t(K);var Q=l(K,2),a=l(s(Q),2),o=s(a);o.value=o.__value="";var d=l(o);oe(d,17,D,fe,(b,W)=>{var N=Fe(),te=s(N,!0);t(N);var A={};U(()=>{C(te,e(W).name),A!==(A=e(W).id)&&(N.value=(N.__value=e(W).id)??"")}),q(b,N)}),t(a),re(2),t(Q);var z=l(Q,2),f=l(s(z),2);xe(f),t(z);var p=l(z,2),j=s(p);j.__click=S;var E=l(j,2),ee=s(E,!0);t(E),t(p),t(O),t(c),t(y),t(w),U(()=>{C(M,e(k)?"Edit Secret":"Create Secret"),B.disabled=e(v)||e(k),a.disabled=e(v),f.disabled=e(v),j.disabled=e(v),E.disabled=e(v),C(ee,e(v)?"Saving...":e(k)?"Update Secret":"Create Secret")}),je("submit",O,b=>{b.preventDefault(),H()}),Z(B,()=>e(n).name,b=>e(n).name=b),be(a,()=>e(n).project_id,b=>e(n).project_id=b),Z(f,()=>e(n).description,b=>e(n).description=b),q(m,w)};G(I,m=>{g()&&m(J)})}q(h,L),ce()}ve(["click"]);function pe(h,r,i){u(r,null),u(i,!0)}var Ae=x("<option> </option>"),He=x('<button class="btn-primary svelte-15swqau">Create Your First Secret</button>'),Ie=x('<div class="empty-state svelte-15swqau"><p class="empty-icon svelte-15swqau">🔐</p> <p class="empty-text svelte-15swqau"> </p> <!></div>'),Je=(h,r,i)=>r(e(i)),Ye=(h,r,i)=>r(e(i)),Be=x('<tr class="svelte-15swqau"><td class="secret-name svelte-15swqau"> </td><td class="svelte-15swqau"> </td><td class="secret-value svelte-15swqau"><!></td><td class="svelte-15swqau"> </td><td class="svelte-15swqau"> </td><td class="actions svelte-15swqau"><button class="btn-action svelte-15swqau">Edit</button> <button class="btn-action btn-danger svelte-15swqau">Delete</button></td></tr>'),Ke=x('<div class="secrets-table svelte-15swqau"><table class="svelte-15swqau"><thead class="svelte-15swqau"><tr><th class="svelte-15swqau">Name</th><th class="svelte-15swqau">Project</th><th class="svelte-15swqau">Value</th><th class="svelte-15swqau">Created</th><th class="svelte-15swqau">Last Used</th><th class="svelte-15swqau">Actions</th></tr></thead><tbody class="svelte-15swqau"></tbody></table></div>'),Qe=x('<div class="secrets-page svelte-15swqau"><header class="page-header svelte-15swqau"><h1 class="svelte-15swqau">Secrets Vault</h1> <button class="btn-primary svelte-15swqau">Create Secret</button></header> <div class="secrets-content svelte-15swqau"><div class="controls svelte-15swqau"><input type="search" placeholder="Search secrets..." class="search-input svelte-15swqau"/> <select class="filter-select svelte-15swqau"><option>All Projects</option><!></select></div> <!></div> <!></div>');function st(h,r){ne(r,!0);let i=P(ie(r.data.secrets||[])),D=ie(r.data.projects||[]),g=P(""),k=P("all"),n=P(!1),v=P(null);const H=R(()=>()=>{let a=e(i);if(e(g)){const o=e(g).toLowerCase();a=a.filter(d=>d.name.toLowerCase().includes(o))}return e(k)!=="all"&&(a=a.filter(o=>o.project_id===e(k))),a}),S=e(H)();function L(a){u(v,a,!0),u(n,!0)}async function I(a){try{const o=e(v)?`/api/secrets/${e(v).id}`:"/api/secrets",d=e(v)?"PUT":"POST",z=await fetch(o,{method:d,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!z.ok)throw new Error("Failed to save secret");const f=await z.json();e(v)?u(i,e(i).map(p=>p.id===e(v).id?f.secret:p),!0):u(i,[f.secret,...e(i)],!0)}catch(o){throw o}}async function J(a){if(confirm(`Delete secret "${a.name}"? This cannot be undone.`))try{if(!(await fetch(`/api/secrets/${a.id}`,{method:"DELETE"})).ok)throw new Error("Failed to delete secret");u(i,e(i).filter(d=>d.id!==a.id),!0)}catch(o){alert(`Error deleting secret: ${o.message}`)}}function m(a){return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}var w=Qe();Ce(a=>{Se.title="Secrets - MeshHook"});var y=s(w),F=l(s(y),2);F.__click=[pe,v,n],t(y);var T=l(y,2),M=s(T),_=s(M);X(_);var c=l(_,2),O=s(c);O.value=O.__value="all";var Y=l(O);oe(Y,17,()=>D,fe,(a,o)=>{var d=Ae(),z=s(d,!0);t(d);var f={};U(()=>{C(z,e(o).name),f!==(f=e(o).id)&&(d.value=(d.__value=e(o).id)??"")}),q(a,d)}),t(c),t(M);var B=l(M,2);{var K=a=>{var o=Ie(),d=l(s(o),2),z=s(d,!0);t(d);var f=l(d,2);{var p=j=>{var E=He();E.__click=[pe,v,n],q(j,E)};G(f,j=>{!e(g)&&e(k)==="all"&&j(p)})}t(o),U(()=>C(z,e(g)||e(k)!=="all"?"No secrets match your filters":"No secrets yet")),q(a,o)},$=a=>{var o=Ke(),d=s(o),z=l(s(d));oe(z,21,()=>S,f=>f.id,(f,p)=>{var j=Be(),E=s(j),ee=s(E,!0);t(E);var b=l(E),W=s(b,!0);t(b);var N=l(b),te=s(N);{let se=R(()=>e(p).value||"••••••••");me(te,{get value(){return e(se)},readonly:!0})}t(N);var A=l(N),he=s(A,!0);t(A);var ae=l(A),ge=s(ae,!0);t(ae);var de=l(ae),ue=s(de);ue.__click=[Je,L,p];var we=l(ue,2);we.__click=[Ye,J,p],t(de),t(j),U((se,ye)=>{var _e;C(ee,e(p).name),C(W,((_e=e(p).project)==null?void 0:_e.name)||"Unknown"),C(he,se),C(ge,ye)},[()=>m(e(p).created_at),()=>e(p).last_used_at?m(e(p).last_used_at):"Never"]),q(f,j)}),t(z),t(d),t(o),q(a,o)};G(B,a=>{S.length===0?a(K):a($,!1)})}t(T);var Q=l(T,2);Ve(Q,{get secret(){return e(v)},get projects(){return D},onSave:I,get isOpen(){return e(n)},set isOpen(a){u(n,a,!0)}}),t(w),Z(_,()=>e(g),a=>u(g,a)),be(c,()=>e(k),a=>u(k,a)),q(h,w),ce()}ve(["click"]);export{st as component};
